<!DOCTYPE html>
<html>
<head>
  <title>Azure AI Search Demo</title>
</head>
<body>

<h2>Employee Policy Search</h2>

<input id="query" placeholder="Search policy" />
<button onclick="search()">Search</button>

<ul id="results"></ul>

<script>
const serviceName = "tcs-search-service";
const indexName = "azureblob-index";
const apiKey = "Ae3zq1sjsML9D2UtpHtWuc308dyCWXmy1UngFxYUvHAzSeDnlgT9";

async function search() {
  const q = document.getElementById("query").value;

  const response = await fetch(
    `https://${serviceName}.search.windows.net/indexes/${indexName}/docs/search?api-version=2023-11-01`,
    {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "api-key": apiKey
      },
      body: JSON.stringify({
        search: q
      })
    }
  );

  const data = await response.json();
  const list = document.getElementById("results");
  list.innerHTML = "";

  if (!data.value || data.value.length === 0) {
    list.innerHTML = "<li>No results found</li>";
    return;
  }

  data.value.forEach(doc => {
    if (doc.content && doc.content.length > 0) {
      doc.content.forEach(item => {
        const li = document.createElement("li");
        li.innerText = `${item.title} (${item.category})`;
        list.appendChild(li);
      });
    }
  });
}
</script>

</body>
</html>
